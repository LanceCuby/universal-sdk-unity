<html><head><style>body {
   color: black;
}
</style></head><body><h1 id="universal-sdk-for-unity">Universal SDK for Unity</h1>
<p>The Universal SDK for Unity provides a modern way of implementing InApp Purchase and Social Login APIs. The features included in this SDK will help you develop a Unity game with an engaging and personalized user experience.</p>
<h2 id="overview">Overview</h2>
<h3 id="features">Features</h3>
<h4 id="android">Android</h4>
<ul>
<li>Google Login</li>
<li>Facebook Login</li>
<li>Apple Login</li>
<li>Google Play Billing Library v3</li>
<li>Firebase Cloud Messaging (FCM)</li>
<li>AndroidX Support</li>
<li>Chrome Custom Tabs</li>
</ul>
<h4 id="ios">iOS</h4>
<ul>
<li>Google Login</li>
<li>Facebook Login</li>
<li>Apple Login</li>
<li>Apple In-App Purchase StoreKit</li>
<li>Apple Push Notification service (APNs)</li>
<li>Capability Support</li>
<li>Safari View Controller</li>
</ul>
<h3 id="dependency">Dependency</h3>
<h4 id="android">Android</h4>
<pre><code><span class="hljs-keyword">implementation</span> <span class="hljs-string">'com.google.firebase:firebase-messaging:22.0.0'</span>
<span class="hljs-keyword">implementation</span> <span class="hljs-string">'android.arch.work:work-runtime:1.0.1'</span>
<span class="hljs-keyword">implementation</span> <span class="hljs-string">'com.android.billingclient:billing:3.0.3'</span>
<span class="hljs-keyword">implementation</span> <span class="hljs-string">'com.google.android.gms:play-services-auth:19.0.0'</span>
<span class="hljs-keyword">implementation</span> <span class="hljs-string">'com.facebook.android:facebook-login:7.1.0'</span>
</code></pre><h4 id="ios">iOS</h4>
<pre><code><span class="hljs-string">'GoogleSignIn'</span>, <span class="hljs-string">'~&gt; 5.0'</span>
<span class="hljs-string">'FBSDKLoginKit'</span>, <span class="hljs-string">'~&gt; 9.0'</span>
</code></pre><h2 id="setting-up-your-project">Setting up your project</h2>
<p>The Universal SDK for Unity provides an interface for using Universal SDK on either iOS or Android platform. To use Universal SDK in Unity Editor and export it to a platform, your development environment needs a few things.</p>
<h3 id="unity-requirements">Unity requirements</h3>
<ul>
<li>Unity 2017.4 or later, with iOS and Android modules installed</li>
<li>A valid subscription for Unity Personal, Unity Plus, or Unity Pro</li>
</ul>
<h3 id="installation-on-ios">Installation on iOS</h3>
<p>To integrate Universal SDK for Unity on iOS, you need:</p>
<ul>
<li>iOS 10.0 or higher as the deployment target</li>
<li>Xcode 10 or higher</li>
</ul>
<p>On iOS, Universal SDK for Unity works as a wrapper for the Universal SDK for iOS Objc. You must use a manual to add the Universal SDK for iOS Objc to your project on iOS.</p>
<h3 id="installation-on-android">Installation on Android</h3>
<p>You must have the Android SDK installed, because Unity will use it to build your project to the Android platform. If you have previously <a href="https://docs.unity3d.com/Manual/android-sdksetup.html">configured Unity for Android development (opens new window)</a>, you already have the Android SDK.</p>
<h2 id="setting-up-social-login">Setting up Social Login</h2>
<p>Please refer to the setting method for each social login:</p>
<h3 id="android">Android</h3>
<blockquote>
<h4 id="google-login">Google Login</h4>
</blockquote>
<ol>
<li><p><a href="https://console.firebase.google.com">Firebase Console</a> <strong>Register Android App.</strong></p>
<p>Register upload key certificate (SHA-1 of Keystore used when building APK)</p>
<p>Select on <a href="https://console.firebase.google.com">Firebase Console</a> <strong>Project Settings &gt; General &gt; Support email Setting</strong>.</p>
</li>
</ol>
<p><img src="https://user-images.githubusercontent.com/20632507/136521132-a91808b7-d0cb-4b1b-814f-74eb03334db5.png" alt="support email"></p>
<ol>
<li>When you register your Firebase app and register your certificate thumbprint, an API key is automatically generated.</li>
</ol>
<p><img src="https://user-images.githubusercontent.com/20632507/136521160-13944f59-60bf-4cd2-b24e-eadb9c537f43.png" alt="aosgooglestep1"></p>
<ol>
<li>Access the <a href="https://console.developers.google.com/apis/credentials">Google API Console</a>. Copy the Client ID <strong>(Web Client ID).</strong></li>
</ol>
<p><img src="https://user-images.githubusercontent.com/20632507/136524108-983d0841-da50-43cf-bcae-9dd69208afbf.png" alt="aosgooglestep2"></p>
<blockquote>
<h4 id="facebook-login">Facebook Login</h4>
</blockquote>
<p><a href="https://developers.facebook.com/apps">Developer Facebook Console</a> &gt; Copy the App ID.</p>
<blockquote>
<h4 id="apple-login">Apple Login</h4>
</blockquote>
<ol>
<li>Go to the Identifiers menu and click the &quot;+&quot; button.</li>
</ol>
<p><img src="https://user-images.githubusercontent.com/20632507/140308507-7158e7f0-884a-46c0-bf04-2df2b785978f.png" alt="applelogin1"></p>
<ol>
<li>We will register a Services ID to receive information about users who have signed in with Apple.</li>
</ol>
<p><img src="https://user-images.githubusercontent.com/20632507/140308587-75e719f4-b1d2-4f1f-b632-f474ffe7bc0e.png" alt="applelogin2"></p>
<ol>
<li><p>Description is the space where the game name will be exposed when Apple Login. (can be modified)</p>
<p>Please write the Identifier to include the domain name. (However, please write it differently from AppID.)</p>
</li>
</ol>
<p><img src="https://user-images.githubusercontent.com/20632507/140308628-4556783e-1b72-4727-9f64-ab7742f81bfb.png" alt="applelogin3"></p>
<ol>
<li>If the Services ID is registered, click the registered Services ID in the Identifiers menu list to go to the setting page.</li>
</ol>
<p><img src="https://user-images.githubusercontent.com/20632507/140308696-e4e9f4fc-acc7-43fc-a055-749ea7229b32.png" alt="applelogin4"></p>
<ol>
<li>click the &quot;+&quot; button next to the Website URLs.<ul>
<li>Primary App ID: Select an App ID to connect</li>
<li>Domains and Subdomains : Please enter the domain of the redirect url.</li>
<li>Return URLs : Please Enter the URL to receive redirect from Apple server. <strong>(You must redirect after receiving it as a post.)</strong></li>
</ul>
</li>
</ol>
<p><img src="https://user-images.githubusercontent.com/20632507/140308771-a0c81456-6e29-4916-b41e-0ed64f3897c5.png" alt="applelogin5"></p>
<blockquote>
<h4 id="set-launchertemplate-gradle">Set launcherTemplate.gradle</h4>
</blockquote>
<pre><code class="lang-groovy">dependencies {
    ...
    }
android {
    ...
    defaultConfig {
        ...
        resValue(<span class="hljs-string">"string"</span>, <span class="hljs-string">"facebook_app_id"</span>, <span class="hljs-string">"com.your.app.id.here"</span>)
        resValue(<span class="hljs-string">"string"</span>, <span class="hljs-string">"google_web_client_id"</span>, <span class="hljs-string">"com.your.client.id.here"</span>)
        resValue(<span class="hljs-string">"string"</span>, <span class="hljs-string">"apple_client_id"</span>, <span class="hljs-string">"com.your.service.id.here"</span>)
        resValue(<span class="hljs-string">"string"</span>, <span class="hljs-string">"redirect_url"</span>, <span class="hljs-string">"your.return.url.here"</span>)
    }
    ...
</code></pre>
<h3 id="ios">iOS</h3>
<blockquote>
<h4 id="google-login">Google Login</h4>
</blockquote>
<ol>
<li><p>Register your iOS app in the Firebase console</p>
</li>
<li><p>Access the <a href="https://console.developers.google.com/apis/credentials">Google API Console</a>.</p>
</li>
</ol>
<p><img src="https://user-images.githubusercontent.com/20632507/140313260-6734922e-2bd1-4b91-ae39-dfe5fd953211.png" alt="iosgooglestep2"></p>
<ol>
<li>Copy the client ID (google_web_client_id) and iOS URL scheme (REVERSED Client ID).</li>
</ol>
<p><img src="https://user-images.githubusercontent.com/20632507/140313293-0b460dbb-abe9-418c-b247-04d2ed16a919.png" alt="iosgooglestep3"></p>
<blockquote>
<h4 id="facebook-login">Facebook Login</h4>
</blockquote>
<p><a href="https://developers.facebook.com/apps">Developer Facebook Console</a> &gt; Copy the App ID.</p>
<blockquote>
<h4 id="apple-login">Apple Login</h4>
</blockquote>
<ol>
<li>Apple Developer Console &gt; Identifiers &gt; Edit your App ID Configuration &gt; Sign In with Apple Check.</li>
<li>Universal iOS SDK &gt; Apple Login Enable Check.</li>
</ol>
<blockquote>
<h4 id="settings-in-tools-universalsdk-edit-settings">Settings in Tools &gt; UniversalSDK &gt; Edit Settings</h4>
</blockquote>
<ul>
<li>If you select the project and OAuth 2.0 items in the <a href="https://console.developers.google.com/apis/credentials">Google API Console</a>, you can check the web client ID and iOS URL schema of the existing project. (Please check the iOS platform)</li>
<li>Enter a value for Facebook App ID.</li>
<li>If you enable Apple Login, even the Capability setting is automatically set when building Unity.</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/20632507/143774011-c959f885-5ce2-407d-9283-7a3472b728ea.png" alt="iossdkeditor"></p>
<h2 id="setting-up-iap">Setting up IAP</h2>
<p>Please refer to the setting method for each store:</p>
<blockquote>
<h3 id="google-store">Google Store</h3>
</blockquote>
<p>Please register your in-app product in <a href="https://play.google.com/apps/publish">Google Play Developer Console</a>. <strong>(However, only consumables are supported)</strong></p>
<blockquote>
<h3 id="apple">Apple</h3>
</blockquote>
<p>Please register your in-app product in <a href="https://developer.apple.com/account">Apple Developer Center</a>. <strong>(However, only consumables are supported)</strong></p>
<h2 id="setting-up-push">Setting up Push</h2>
<h3 id="fcm">FCM</h3>
<ol>
<li><p>Select on <a href="https://console.firebase.google.com">Firebase Console</a> <strong>Project Settings &gt; General &gt; Download the google-services.json</strong>.</p>
</li>
<li><p>Convert the google-services.json file to xml format. File conversion is supported by <a href="https://dandar3.github.io/android/google-services-json-to-xml.html">Convert google-services.json to values XML</a>.</p>
</li>
<li><p>Copy the converted google-services.xml file to <code>Assets/Plugins/Android/res/values</code>.</p>
</li>
</ol>
<h3 id="apns">APNS</h3>
<p>Apple Developer Center &gt; Keys &gt; Create Key(+) &gt; Register a New Key &gt; Generate Key ID.</p>
<p><img src="https://user-images.githubusercontent.com/20632507/140489272-7bd168e1-f3f8-4ed4-a9ee-178deb7f4bb4.png" alt="apns1"></p>
<h3 id="how-to-use-the-test-tool">How to use the TEST TOOL</h3>
<ul>
<li><a href="https://github.com/onmyway133/PushNotifications">PushNotifications Tool</a></li>
</ul>
<h2 id="integrating-universal-sdk-with-your-unity-game">Integrating Universal SDK with your Unity game</h2>
<h3 id="add-universalsdk-prefab-to-your-scene">Add UniversalSDK prefab to your scene</h3>
<p>After importing the package, in your <strong>Project</strong> panel, you&#39;ll find a <strong>UniversalSDK</strong> prefab under <code>Assets/UniversalSDK/</code>. Drag it to the <strong>Hierarchy</strong> panel of the scene to which you want to add Universal Login:</p>
<p><img src="https://user-images.githubusercontent.com/20632507/136521043-f4f8d88d-0c7f-4df6-a30c-e741076debe2.png" alt="add prefab"></p>
<h3 id="update-player-settings">Update player settings</h3>
<p>Before you continue to implement use Universal SDK APIs in your game, follow the steps below to make sure your project player setting is correct.</p>
<blockquote>
<h4 id="settings-for-android-export">Settings for Android export</h4>
</blockquote>
<ol>
<li>Select <strong>File &gt; Build Settings</strong>.</li>
<li>Click <strong>Player Settings</strong>.</li>
<li>Select Platform &gt; <strong>Other Settings</strong>.</li>
<li>Set <strong>Minimum API Level</strong> to at least <strong>API level 19</strong>.</li>
<li>Set <strong>Target API Level</strong> to <strong>API Level 29 and 30.</strong></li>
<li>Under <strong>Publishing Settings</strong>, enable <strong>Custom Gradle Template</strong>. (Move the .gradle files from &#39;Assets/UniversalSDK/Plugins/Android&#39; to &#39;Assets/Plugins/Android&#39;.)</li>
</ol>
<blockquote>
<h4 id="settings-for-ios-export">Settings for iOS export</h4>
</blockquote>
<ol>
<li>Select <strong>File &gt; Build Settings</strong>.</li>
<li>Click <strong>Player Settings</strong>.</li>
<li>Select Platform &gt; <strong>Other Settings</strong>.</li>
<li>Set <strong>Target minimum iOS Version</strong> to at least <code>10.0</code>.</li>
</ol>
<h3 id="implement-login-with-social">Implement login with Social</h3>
<p>Now, you can implement login with Social in the scene where the UniversalSDK (GameObject) exists. For example:</p>
<pre><code class="lang-csharp"><span class="hljs-keyword">using</span> Universal.UniversalSDK;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">LoginController</span> : <span class="hljs-title">MonoBehaviour</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnClickExampleLogin</span>(<span class="hljs-params"></span>)
    </span>{        
        UniversalSDK.Ins.Login(LoginType.GOOGLE,
            result =&gt;
            {
                result.Match(
                    <span class="hljs-keyword">value</span> =&gt;
                    {
                        UpdateLoginResult(<span class="hljs-keyword">value</span>);
                    },
                    error =&gt;
                    {
                        messageText.text = error.Message;
                    });
            });
    }
}
</code></pre>
<p>Universal SDK for Unity supports only iOS and Android for now. It will always return an error if you run it in Unity Editor play mode. To test it, you need to export your scene to either an iOS or Android device.</p>
<p>If you are using CocoaPods as your dependency manager, after building the game to an Xcode project, open the <code>Unity-iPhone.xcworkspace</code> file instead of the original <code>Unity-iPhone.xcodeproj</code>.</p>
<h3 id="logout">Logout</h3>
<p>During social login, only Google supports <code>Logout</code>. For other social logins, please log out through each social setting.</p>
<pre><code class="lang-c#">UniversalSDK.Ins.Logout(result =&gt;
{
    result.<span class="hljs-built_in">Match</span>(
        value =&gt;
        {
            <span class="hljs-comment">//value.Code</span>
            <span class="hljs-comment">//value.Message</span>
        },
        error =&gt;
        {
            <span class="hljs-comment">//error.Code</span>
            <span class="hljs-comment">//error.Message</span>
        });
});
</code></pre>
<h3 id="purchase">Purchase</h3>
<h4 id="initbilling">InitBilling</h4>
<p>After initializing the payment module, a list of in-app products available for purchase is delivered.</p>
<pre><code class="lang-c#">UniversalSDK.<span class="hljs-keyword">Ins.InitBilling(scopes, </span>result =&gt;
{
    result.Match(
        value =&gt;
        {          
            for (int i = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; value.Products.Length; i++)</span>
            {
                UpdateRawSection(value.Products[i])<span class="hljs-comment">;</span>
            }                              
        },
        error =&gt;
        {
            titleText<span class="hljs-meta">.text</span> = error<span class="hljs-meta">.Code</span>.ToString()<span class="hljs-comment">;</span>
            messageText<span class="hljs-meta">.text</span> = error.Message<span class="hljs-comment">;</span>
            popup_panel.SetActive(true)<span class="hljs-comment">;</span>
        })<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
</code></pre>
<h4 id="restore-purchase">Restore Purchase</h4>
<p>Payment information list is delivered after processing for unconsumed payments. (Callable only after payment initialization)</p>
<pre><code class="lang-c#"><span class="hljs-type">UniversalSDK</span>.<span class="hljs-type">Ins</span>.<span class="hljs-type">RestorePurchases</span>(result =&gt;
{
    result.<span class="hljs-type">Match</span>(
        <span class="hljs-keyword">value</span> =&gt;
        {
            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">value</span>.<span class="hljs-type">PurchaseDatas</span> != null)
            {
                foreach (<span class="hljs-type">PurchaseData</span> data <span class="hljs-keyword">in</span> <span class="hljs-keyword">value</span>.<span class="hljs-type">PurchaseDatas</span>)
                {
                    <span class="hljs-type">UpdateRawSection</span>(data);
                }
            }
            <span class="hljs-keyword">else</span>
            {
                <span class="hljs-type">Debug</span>.<span class="hljs-type">Log</span>(<span class="hljs-string">"PurchaseDatas is NULL"</span>);
            }                    
        },
        error =&gt;
        {
            <span class="hljs-type">UpdateRawSection</span>(error);
        });
});
</code></pre>
<h4 id="in-app-product-payment">In-app product payment</h4>
<p>Google and Apple payments are possible with one of the functions below.</p>
<pre><code class="lang-c#"><span class="hljs-type">UniversalSDK</span>.<span class="hljs-type">Ins</span>.<span class="hljs-type">InAppPurchase</span>(<span class="hljs-string">"product_id"</span>, result =&gt;
{
    result.<span class="hljs-type">Match</span>(
        <span class="hljs-keyword">value</span> =&gt;
        {
            <span class="hljs-type">UpdateRawSection</span>(<span class="hljs-keyword">value</span>);
        },
        error =&gt;
        {
            <span class="hljs-type">UpdateRawSection</span>(error);
        });
});
</code></pre>
<h4 id="each-store-error-message">Each Store Error Message</h4>
<ul>
<li><a href="https://developer.android.com/reference/com/android/billingclient/api/BillingClient.BillingResponseCode?hl=ko">Google Store</a></li>
<li><a href="https://developer.apple.com/documentation/storekit/skerror#topics">Apple Store</a></li>
</ul>
<h3 id="push">Push</h3>
<p>When you log in, a pushtoken is issued through LoginResult.</p>
<h3 id="errorcode">ErrorCode</h3>
<table>
<thead>
<tr>
<th>Error</th>
<th>Code</th>
<th>Desc</th>
</tr>
</thead>
<tbody>
<tr>
<td>CANCEL</td>
<td>1100</td>
<td>User Cancel</td>
</tr>
<tr>
<td>AUTHENTICATION_AGENT_ERROR</td>
<td>1101</td>
<td>Unknown authentication error</td>
</tr>
<tr>
<td>PURCHASE_ERROR</td>
<td>1102</td>
<td>Unknown payment error</td>
</tr>
</tbody>
</table>
</body></html>